# SqueezeNet å±‚è¿æ¥å…³ç³»è¯¦è§£

## ğŸ¯ å®Œæ•´ç½‘ç»œç»“æ„å›¾

```
è¾“å…¥: (N, 3, 32, 32) CIFAR-10 å›¾åƒ
â”‚
â”œâ”€â–º Conv1 (3x3, stride=1, pad=1)
â”‚   è¾“å…¥:  (N, 3, 32, 32)
â”‚   å·ç§¯:  3 channels â†’ 96 channels
â”‚   è¾“å‡º:  (N, 96, 32, 32)
â”‚   â””â”€â–º ReLU
â”‚       â””â”€â–º [è®°å½•ç‚¹: block_output.conv1]
â”‚           â””â”€â–º [TAPè¿‘ä¼¼åº”ç”¨ç‚¹]
â”‚               â””â”€â–º MaxPool1 (3x3, stride=2)
â”‚                   è¾“å‡º: (N, 96, 16, 16)
â”‚
â”œâ”€â–º Fire2 (squeeze=16, expand=64+64)
â”‚   è¾“å…¥:  (N, 96, 16, 16)
â”‚   â”‚
â”‚   â”œâ”€â–º Squeezeå±‚ (1x1 Conv)
â”‚   â”‚   96 â†’ 16 channels
â”‚   â”‚   è¾“å‡º: (N, 16, 16, 16)
â”‚   â”‚   â””â”€â–º ReLU
â”‚   â”‚
â”‚   â”œâ”€â–º Expandå±‚ (å¹¶è¡Œåˆ†æ”¯)
â”‚   â”‚   â”œâ”€â–º Expand1x1 (1x1 Conv): 16 â†’ 64 channels
â”‚   â”‚   â”‚   è¾“å‡º: (N, 64, 16, 16)
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â–º Expand3x3 (3x3 Conv, pad=1): 16 â†’ 64 channels
â”‚   â”‚       è¾“å‡º: (N, 64, 16, 16)
â”‚   â”‚
â”‚   â””â”€â–º Concat (åœ¨é€šé“ç»´åº¦)
â”‚       64 + 64 = 128 channels
â”‚       è¾“å‡º: (N, 128, 16, 16)
â”‚       â””â”€â–º ReLU
â”‚           â””â”€â–º [è®°å½•ç‚¹: block_output.fire2]
â”‚               â””â”€â–º [TAPè¿‘ä¼¼åº”ç”¨ç‚¹]
â”‚
â”œâ”€â–º Fire3 (squeeze=16, expand=64+64)
â”‚   è¾“å…¥:  (N, 128, 16, 16)
â”‚   â”‚
â”‚   â”œâ”€â–º Squeeze: 128 â†’ 16
â”‚   â”œâ”€â–º Expand1x1: 16 â†’ 64
â”‚   â”œâ”€â–º Expand3x3: 16 â†’ 64
â”‚   â””â”€â–º Concat: 128 channels
â”‚       è¾“å‡º: (N, 128, 16, 16)
â”‚       â””â”€â–º [è®°å½•ç‚¹: block_output.fire3]
â”‚           â””â”€â–º [TAPè¿‘ä¼¼åº”ç”¨ç‚¹]
â”‚
â”œâ”€â–º Fire4 (squeeze=32, expand=128+128)
â”‚   è¾“å…¥:  (N, 128, 16, 16)
â”‚   â”‚
â”‚   â”œâ”€â–º Squeeze: 128 â†’ 32
â”‚   â”œâ”€â–º Expand1x1: 32 â†’ 128
â”‚   â”œâ”€â–º Expand3x3: 32 â†’ 128
â”‚   â””â”€â–º Concat: 256 channels
â”‚       è¾“å‡º: (N, 256, 16, 16)
â”‚       â””â”€â–º [è®°å½•ç‚¹: block_output.fire4] â˜…æ³¨æ„åŠ›è½¬ç§»å±‚â˜…
â”‚           â””â”€â–º [TAPè¿‘ä¼¼åº”ç”¨ç‚¹]
â”‚               â””â”€â–º MaxPool2 (3x3, stride=2)
â”‚                   è¾“å‡º: (N, 256, 8, 8)
â”‚
â”œâ”€â–º Fire5 (squeeze=32, expand=128+128)
â”‚   è¾“å…¥:  (N, 256, 8, 8)
â”‚   â”‚
â”‚   â”œâ”€â–º Squeeze: 256 â†’ 32
â”‚   â”œâ”€â–º Expand1x1: 32 â†’ 128
â”‚   â”œâ”€â–º Expand3x3: 32 â†’ 128
â”‚   â””â”€â–º Concat: 256 channels
â”‚       è¾“å‡º: (N, 256, 8, 8)
â”‚       â””â”€â–º [è®°å½•ç‚¹: block_output.fire5]
â”‚           â””â”€â–º [TAPè¿‘ä¼¼åº”ç”¨ç‚¹]
â”‚
â”œâ”€â–º Fire6 (squeeze=48, expand=192+192)
â”‚   è¾“å…¥:  (N, 256, 8, 8)
â”‚   â”‚
â”‚   â”œâ”€â–º Squeeze: 256 â†’ 48
â”‚   â”œâ”€â–º Expand1x1: 48 â†’ 192
â”‚   â”œâ”€â–º Expand3x3: 48 â†’ 192
â”‚   â””â”€â–º Concat: 384 channels
â”‚       è¾“å‡º: (N, 384, 8, 8)
â”‚       â””â”€â–º [è®°å½•ç‚¹: block_output.fire6] â˜…æ³¨æ„åŠ›è½¬ç§»å±‚â˜…
â”‚           â””â”€â–º [TAPè¿‘ä¼¼åº”ç”¨ç‚¹]
â”‚
â”œâ”€â–º Fire7 (squeeze=48, expand=192+192)
â”‚   è¾“å…¥:  (N, 384, 8, 8)
â”‚   â”‚
â”‚   â”œâ”€â–º Squeeze: 384 â†’ 48
â”‚   â”œâ”€â–º Expand1x1: 48 â†’ 192
â”‚   â”œâ”€â–º Expand3x3: 48 â†’ 192
â”‚   â””â”€â–º Concat: 384 channels
â”‚       è¾“å‡º: (N, 384, 8, 8)
â”‚       â””â”€â–º [è®°å½•ç‚¹: block_output.fire7]
â”‚           â””â”€â–º [TAPè¿‘ä¼¼åº”ç”¨ç‚¹]
â”‚
â”œâ”€â–º Fire8 (squeeze=64, expand=256+256)
â”‚   è¾“å…¥:  (N, 384, 8, 8)
â”‚   â”‚
â”‚   â”œâ”€â–º Squeeze: 384 â†’ 64
â”‚   â”œâ”€â–º Expand1x1: 64 â†’ 256
â”‚   â”œâ”€â–º Expand3x3: 64 â†’ 256
â”‚   â””â”€â–º Concat: 512 channels
â”‚       è¾“å‡º: (N, 512, 8, 8)
â”‚       â””â”€â–º [è®°å½•ç‚¹: block_output.fire8] â˜…æ³¨æ„åŠ›è½¬ç§»å±‚â˜…
â”‚           â””â”€â–º [TAPè¿‘ä¼¼åº”ç”¨ç‚¹]
â”‚               â””â”€â–º MaxPool3 (3x3, stride=2)
â”‚                   è¾“å‡º: (N, 512, 4, 4)
â”‚
â”œâ”€â–º Fire9 (squeeze=64, expand=256+256)
â”‚   è¾“å…¥:  (N, 512, 4, 4)
â”‚   â”‚
â”‚   â”œâ”€â–º Squeeze: 512 â†’ 64
â”‚   â”œâ”€â–º Expand1x1: 64 â†’ 256
â”‚   â”œâ”€â–º Expand3x3: 64 â†’ 256
â”‚   â””â”€â–º Concat: 512 channels
â”‚       è¾“å‡º: (N, 512, 4, 4)
â”‚       â””â”€â–º [è®°å½•ç‚¹: block_output.fire9]
â”‚           â””â”€â–º [TAPè¿‘ä¼¼åº”ç”¨ç‚¹]
â”‚
â”œâ”€â–º Dropout (p=0.5)
â”‚   è¾“å‡º: (N, 512, 4, 4)
â”‚
â”œâ”€â–º Conv10 (1x1 Conv, åˆ†ç±»å±‚)
â”‚   512 â†’ 10 channels
â”‚   è¾“å‡º: (N, 10, 4, 4)
â”‚   â””â”€â–º ReLU
â”‚       â””â”€â–º AdaptiveAvgPool2d (â†’ 1x1)
â”‚           è¾“å‡º: (N, 10, 1, 1)
â”‚           â””â”€â–º Flatten
â”‚               è¾“å‡º: (N, 10)
â”‚
â””â”€â–º è¾“å‡º: Logits for 10 classes
```

---

## ğŸ“Š é€šé“æ•°å˜åŒ–æ€»ç»“

| å±‚å | è¾“å…¥é€šé“ | Squeeze | Expand1x1 | Expand3x3 | è¾“å‡ºé€šé“ | ç©ºé—´å°ºå¯¸ |
|------|---------|---------|-----------|-----------|---------|---------|
| **è¾“å…¥** | 3 | - | - | - | 3 | 32Ã—32 |
| **Conv1** | 3 | - | - | - | 96 | 32Ã—32 |
| â†“MaxPool1 | - | - | - | - | - | **16Ã—16** |
| **Fire2** | 96 | 16 | 64 | 64 | 128 | 16Ã—16 |
| **Fire3** | 128 | 16 | 64 | 64 | 128 | 16Ã—16 |
| **Fire4** | 128 | 32 | 128 | 128 | 256 | 16Ã—16 |
| â†“MaxPool2 | - | - | - | - | - | **8Ã—8** |
| **Fire5** | 256 | 32 | 128 | 128 | 256 | 8Ã—8 |
| **Fire6** | 256 | 48 | 192 | 192 | 384 | 8Ã—8 |
| **Fire7** | 384 | 48 | 192 | 192 | 384 | 8Ã—8 |
| **Fire8** | 384 | 64 | 256 | 256 | 512 | 8Ã—8 |
| â†“MaxPool3 | - | - | - | - | - | **4Ã—4** |
| **Fire9** | 512 | 64 | 256 | 256 | 512 | 4Ã—4 |
| **Conv10** | 512 | - | - | - | 10 | 4Ã—4 |
| **AvgPool** | - | - | - | - | - | **1Ã—1** |
| **è¾“å‡º** | - | - | - | - | 10 | - |

---

## ğŸ”— å±‚ä¸å±‚è¿æ¥å…³ç³»è¯¦è§£

### 1ï¸âƒ£ **é¡ºåºè¿æ¥ï¼ˆSequentialï¼‰**

```
Conv1 â†’ Fire2 â†’ Fire3 â†’ Fire4 â†’ Fire5 â†’ Fire6 â†’ Fire7 â†’ Fire8 â†’ Fire9 â†’ Conv10
```

**ç‰¹ç‚¹ï¼š**
- ä¸¥æ ¼çš„å‰é¦ˆç»“æ„ï¼Œæ²¡æœ‰è·³è·ƒè¿æ¥
- æ¯å±‚çš„è¾“å‡ºç›´æ¥ä½œä¸ºä¸‹ä¸€å±‚çš„è¾“å…¥
- ä¸VGGç±»ä¼¼çš„å †å è®¾è®¡

### 2ï¸âƒ£ **Fireæ¨¡å—å†…éƒ¨è¿æ¥ï¼ˆParallel + Concatï¼‰**

```
è¾“å…¥
  â†“
Squeeze (1x1 Conv)
  â†“
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â†“             â†“             â†“
Expand1x1    Expand3x3     (å¹¶è¡Œ)
  â†“             â†“
  â””â”€â”€â”€â”€â”€â”€Concatâ”€â”€â”€â”€â”€â”€â”˜
         â†“
       è¾“å‡º
```

**å…³é”®ç‚¹ï¼š**
- **Squeezeç“¶é¢ˆ**ï¼šå¤§å¹…å‹ç¼©é€šé“æ•°ï¼ˆä¾‹å¦‚256â†’48ï¼‰
- **å¹¶è¡Œåˆ†æ”¯**ï¼š1x1å’Œ3x3å·ç§¯åŒæ—¶å¤„ç†
- **é€šé“æ‹¼æ¥**ï¼š`torch.cat([out1x1, out3x3], dim=1)`
- **è¾“å‡ºé€šé“æ•° = Expand1x1é€šé“ + Expand3x3é€šé“**

### 3ï¸âƒ£ **é™é‡‡æ ·è¿æ¥ï¼ˆPoolingï¼‰**

```
Fire4 (16Ã—16) â†’ MaxPool2 â†’ Fire5 (8Ã—8)
Fire8 (8Ã—8)   â†’ MaxPool3 â†’ Fire9 (4Ã—4)
```

**ç‰¹ç‚¹ï¼š**
- åªåœ¨ç‰¹å®šä½ç½®é™é‡‡æ ·ï¼ˆfire4åã€fire8åï¼‰
- å»¶è¿Ÿé™é‡‡æ ·ç­–ç•¥ï¼šå°½å¯èƒ½ä¿ç•™ç©ºé—´åˆ†è¾¨ç‡
- ä¸VGGåœ¨æ¯ä¸ªblockåé™é‡‡æ ·ä¸åŒ

---

## ğŸ¨ Fireæ¨¡å—è¯¦ç»†ç¤ºä¾‹

### Fire4 æ¨¡å—å®Œæ•´æ•°æ®æµ

```
è¾“å…¥: (N, 128, 16, 16)
â”‚
â”œâ”€â–º Squeeze Conv (1x1)
â”‚   æƒé‡: (32, 128, 1, 1)
â”‚   è¾“å‡º: (N, 32, 16, 16)  â† å‹ç¼©åˆ°25%
â”‚   â””â”€â–º ReLU
â”‚
â”œâ”€â–º Expand åˆ†æ”¯
â”‚   â”‚
â”‚   â”œâ”€â–º Branch A: Expand1x1
â”‚   â”‚   æƒé‡: (128, 32, 1, 1)
â”‚   â”‚   è¾“å‡º: (N, 128, 16, 16)
â”‚   â”‚
â”‚   â””â”€â–º Branch B: Expand3x3
â”‚       æƒé‡: (128, 32, 3, 3)
â”‚       padding=1 ä¿æŒå°ºå¯¸
â”‚       è¾“å‡º: (N, 128, 16, 16)
â”‚
â”œâ”€â–º Concat æ“ä½œ
â”‚   torch.cat([Branch A, Branch B], dim=1)
â”‚   128 + 128 = 256 channels
â”‚   è¾“å‡º: (N, 256, 16, 16)
â”‚   â””â”€â–º ReLU
â”‚
â””â”€â–º è®°å½• & TAPè¿‘ä¼¼
    è®°å½•ç‚¹: block_output.fire4
    TAPè¿‘ä¼¼: 4ä¸ªINT8ç  [t1, v1, t2, v2]
    è¾“å‡º: (N, 256, 16, 16) (é‡åŒ–å)
```

### è®¡ç®—é‡åˆ†æ

**Fire4æ¨¡å— (128â†’256):**
```python
# Squeezeé˜¶æ®µ
squeeze_ops = 128 Ã— 32 Ã— 1 Ã— 1 Ã— (16Ã—16) = 1,048,576

# Expand1x1é˜¶æ®µ
expand1x1_ops = 32 Ã— 128 Ã— 1 Ã— 1 Ã— (16Ã—16) = 1,048,576

# Expand3x3é˜¶æ®µ
expand3x3_ops = 32 Ã— 128 Ã— 3 Ã— 3 Ã— (16Ã—16) = 9,437,184

# æ€»è®¡
total_ops = 1,048,576 + 1,048,576 + 9,437,184 = 11,534,336

# å¯¹æ¯”æ ‡å‡†3x3å·ç§¯ (128â†’256)
standard_conv_ops = 128 Ã— 256 Ã— 3 Ã— 3 Ã— (16Ã—16) = 75,497,472

# å‹ç¼©æ¯”
ratio = 75,497,472 / 11,534,336 â‰ˆ 6.5å€
```

---

## ğŸ†š ä¸å…¶ä»–ç½‘ç»œçš„è¿æ¥å·®å¼‚

### SqueezeNet vs VGG16

| ç‰¹æ€§ | SqueezeNet | VGG16 |
|------|-----------|-------|
| **åŸºæœ¬å•å…ƒ** | Fireæ¨¡å— | 3x3 Conv |
| **å†…éƒ¨è¿æ¥** | å¹¶è¡Œ+æ‹¼æ¥ | é¡ºåºå †å  |
| **è·³è·ƒè¿æ¥** | æ—  | æ—  |
| **é™é‡‡æ ·** | å»¶è¿Ÿé™é‡‡æ ·(3æ¬¡) | é¢‘ç¹é™é‡‡æ ·(5æ¬¡) |
| **é€šé“å˜åŒ–** | æ¸è¿›å¼å¢é•¿ | å€å¢å¼å¢é•¿ |

### SqueezeNet vs ResNet

| ç‰¹æ€§ | SqueezeNet | ResNet-18 |
|------|-----------|-----------|
| **åŸºæœ¬å•å…ƒ** | Fireæ¨¡å— | BasicBlock |
| **å†…éƒ¨è¿æ¥** | å¹¶è¡Œåˆ†æ”¯ | æ®‹å·®è¿æ¥ |
| **è·³è·ƒè¿æ¥** | æ—  | æœ‰(shortcut) |
| **æ¢¯åº¦æµ** | å‰é¦ˆ | ç›´é€šé€šé“ |

### SqueezeNet vs AlexNet

| ç‰¹æ€§ | SqueezeNet | AlexNet |
|------|-----------|---------|
| **å·ç§¯ç±»å‹** | 1x1ä¸ºä¸» | å¤§å·ç§¯æ ¸ |
| **è¿æ¥æ–¹å¼** | Fireå¹¶è¡Œ | é¡ºåºè¿æ¥ |
| **å‚æ•°é‡** | 1.2M | 3M |
| **FCå±‚** | æ— (GAP) | 2ä¸ªå¤§FC |

---

## ğŸ” å…³é”®è¿æ¥ç‚¹è¯´æ˜

### 1. **Squeezeç“¶é¢ˆè¿æ¥**

```python
# Fireæ¨¡å—çš„ç“¶é¢ˆè®¾è®¡
input_channels = 256
squeeze_channels = 48  # å‹ç¼©åˆ°18.75%

# è¿™ä¸ªç“¶é¢ˆæ˜¯å…³é”®ï¼š
# - å‡å°‘åç»­expandå±‚çš„è®¡ç®—é‡
# - ç±»ä¼¼MobileNetçš„depthwiseæ€æƒ³
# - å¯¹é‡åŒ–è¯¯å·®æ•æ„Ÿï¼ˆé€šé“æ•°å°‘ï¼‰
```

### 2. **å¹¶è¡Œåˆ†æ”¯è¿æ¥**

```python
# 1x1å’Œ3x3å¹¶è¡Œå¤„ç†
out1x1 = self.expand1x1(squeezed)  # å±€éƒ¨ç‰¹å¾
out3x3 = self.expand3x3(squeezed)  # æ„Ÿå—é‡ç‰¹å¾

# æ‹¼æ¥èåˆä¸åŒå°ºåº¦ç‰¹å¾
output = torch.cat([out1x1, out3x3], dim=1)
```

**é‡åŒ–æŒ‘æˆ˜ï¼š**
- ä¸¤ä¸ªåˆ†æ”¯çš„scaleå¯èƒ½ä¸åŒ
- Concatæ“ä½œéœ€è¦ç»Ÿä¸€scale
- å»ºè®®å¯¹æ•´ä¸ªFireæ¨¡å—è¾“å‡ºè¿›è¡ŒTAPè¿‘ä¼¼

### 3. **MaxPoolé™é‡‡æ ·è¿æ¥**

```
Fire4 (256 ch, 16Ã—16) â†’ MaxPool â†’ Fire5 (256 ch, 8Ã—8)
       â†‘ æ³¨æ„åŠ›å±‚                          â†‘ æ™®é€šå±‚
```

**è®¾è®¡ç†ç”±ï¼š**
- Fire4åé™é‡‡æ ·ï¼šæ—©æœŸç‰¹å¾å·²æå–
- ä¿æŒ8Ã—8çš„ç©ºé—´åˆ†è¾¨ç‡è¿›è¡Œæ·±å±‚ç‰¹å¾å­¦ä¹ 
- æœ€åé™åˆ°4Ã—4ç”¨äºå…¨å±€ç‰¹å¾

---

## ğŸ“‹ é‡åŒ–è¿‘ä¼¼å±‚æ€»ç»“

### 9ä¸ªé‡åŒ–å±‚çš„è¿æ¥å…³ç³»

```
Layer    è¾“å…¥â†’è¾“å‡ºé€šé“    ç©ºé—´å°ºå¯¸    è¿æ¥ç±»å‹         æ³¨æ„åŠ›å±‚
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
conv1    3 â†’ 96          32Ã—32      Sequential       -
fire2    96 â†’ 128        16Ã—16      Sequential       -
fire3    128 â†’ 128       16Ã—16      Sequential       -
fire4    128 â†’ 256       16Ã—16      Sequential       â˜…
fire5    256 â†’ 256       8Ã—8        Sequential       -
fire6    256 â†’ 384       8Ã—8        Sequential       â˜…
fire7    384 â†’ 384       8Ã—8        Sequential       -
fire8    384 â†’ 512       8Ã—8        Sequential       â˜…
fire9    512 â†’ 512       4Ã—4        Sequential       -

conv10   512 â†’ 10        4Ã—4        åˆ†ç±»å±‚(ä¸é‡åŒ–)   -
```

### æ³¨æ„åŠ›è½¬ç§»å±‚é€‰æ‹©

```python
attention_layers = ['fire4', 'fire6', 'fire8']
```

**é€‰æ‹©ç†ç”±ï¼š**
1. **fire4** (256ch, 16Ã—16)
   - Stage2æœ«å°¾ï¼Œæ—©æœŸç‰¹å¾å……åˆ†æå–
   - é™é‡‡æ ·å‰çš„å…³é”®ä½ç½®
   
2. **fire6** (384ch, 8Ã—8)
   - Stage3ä¸­éƒ¨ï¼Œä¸­å±‚è¯­ä¹‰ç‰¹å¾
   - é€šé“æ•°å¢é•¿çš„è½¬æŠ˜ç‚¹
   
3. **fire8** (512ch, 8Ã—8)
   - Stage3æœ«å°¾ï¼Œæ·±å±‚æŠ½è±¡ç‰¹å¾
   - æœ€å¤§é€šé“æ•°ï¼Œç‰¹å¾æœ€ä¸°å¯Œ

---

## ğŸ¯ å®é™…åº”ç”¨å»ºè®®

### 1. **è®­ç»ƒæ—¶çš„è¿æ¥å¤„ç†**

```python
# approx_train_ppo.py ä¸­
SQUEEZENET_LAYERS = [
    "conv1",
    "fire2", "fire3", "fire4",
    "fire5", "fire6", "fire7", "fire8",
    "fire9"
]

# æ¯å±‚ç‹¬ç«‹è¿›è¡ŒTAPè¿‘ä¼¼
for layer_name in SQUEEZENET_LAYERS:
    # æ”¶é›†è¯¥å±‚çš„æ¿€æ´»ç›´æ–¹å›¾
    # ä½¿ç”¨PPOä¼˜åŒ–INT8ç 
    # åº”ç”¨TAPè¿‘ä¼¼
```

### 2. **Fireæ¨¡å—çš„æ•´ä½“å¤„ç†**

```python
# åœ¨_forward_fire_moduleä¸­
# 1. å®Œæ•´æ‰§è¡ŒFireæ¨¡å—ï¼ˆsqueeze + expand + concatï¼‰
# 2. åœ¨è¾“å‡ºæ¿€æ´»åè®°å½•
# 3. å¯¹æ•´ä½“è¾“å‡ºåº”ç”¨TAPè¿‘ä¼¼ï¼ˆè€Œéåˆ†åˆ«è¿‘ä¼¼1x1å’Œ3x3åˆ†æ”¯ï¼‰

self.recorder.record(f"block_output.{layer_name}", x)
x = self._apply_tap_approx(x, layer_name)
```

### 3. **æ³¨æ„åŠ›å¯¹é½çš„è¿æ¥å¤„ç†**

```python
# attention_transfer.py ä¸­
# å¯¹fire4, fire6, fire8çš„è¾“å‡ºç‰¹å¾å›¾è¿›è¡Œå¯¹é½
# ç¡®ä¿teacherå’Œstudentåœ¨è¿™äº›å…³é”®ä½ç½®çš„ç‰¹å¾åˆ†å¸ƒä¸€è‡´

loss_at = attention_transfer.compute_loss(
    teacher_features=['fire4_out', 'fire6_out', 'fire8_out'],
    student_features=['fire4_out', 'fire6_out', 'fire8_out']
)
```

---

## ğŸ’¡ æ€»ç»“

**SqueezeNetçš„è¿æ¥ç‰¹ç‚¹ï¼š**
1. âœ… **é¡ºåºè¿æ¥ä¸ºä¸»**ï¼šç®€å•å‰é¦ˆï¼Œæ˜“äºé‡åŒ–
2. âœ… **Fireæ¨¡å—å†…å¹¶è¡Œ**ï¼š1x1å’Œ3x3åˆ†æ”¯èåˆ
3. âœ… **å»¶è¿Ÿé™é‡‡æ ·**ï¼šä¿ç•™æ›´å¤šç©ºé—´ä¿¡æ¯
4. âœ… **æ— è·³è·ƒè¿æ¥**ï¼šé¿å…ResNetå¼çš„æ®‹å·®åŠ æ³•
5. âœ… **æ¸è¿›å¼é€šé“å¢é•¿**ï¼š96â†’128â†’256â†’384â†’512

**é‡åŒ–å‹å¥½æ€§ï¼š**
- âœ“ å¤§é‡1x1å·ç§¯ï¼Œè®¡ç®—ç®€å•
- âœ“ æ— å¤æ‚çš„æ®‹å·®åŠ æ³•ï¼ˆé¿å…scaleå¯¹é½é—®é¢˜ï¼‰
- âœ“ Fireæ¨¡å—æ•´ä½“å¯ä½œä¸ºé‡åŒ–å•å…ƒ
- âš ï¸ Concatæ“ä½œéœ€æ³¨æ„scaleç»Ÿä¸€
- âš ï¸ Squeezeç“¶é¢ˆå¯¹é‡åŒ–è¯¯å·®æ•æ„Ÿ

**ä¸ç°æœ‰æ¡†æ¶çš„å…¼å®¹æ€§ï¼š**
- è®°å½•ç‚¹æ ¼å¼ï¼š`block_output.{layer_name}`
- å®Œå…¨å…¼å®¹å½“å‰çš„TAPè¿‘ä¼¼æµç¨‹
- æ³¨æ„åŠ›è½¬ç§»åªéœ€ä¿®æ”¹å±‚ååˆ—è¡¨
- æ— éœ€ç‰¹æ®Šå¤„ç†FCå±‚ï¼ˆä½¿ç”¨GAPä»£æ›¿ï¼‰
